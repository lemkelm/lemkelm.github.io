<!DOCTYPE html>
<html>

    <head>
        <meta http-equiv='cache-control' content='no-cache'>
        <meta http-equiv='expires' content='0'>
        <meta http-equiv='pragma' content='no-cache'>
        <meta charset="utf-8">
        <title>Rating</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

        <!--   <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-dragdata@1.1.3/dist/chartjs-plugin-dragdata.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/roughjs@3.1.0/dist/rough.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-rough@latest/dist/chartjs-plugin-rough.min.js"></script>-->
        <script src="https://code.jquery.com/jquery-3.6.3.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.6.0/chart.min.js"></script>
        <!--  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.2.1/chart.min.js"></script>-->
        <script
            src="https://cdn.jsdelivr.net/npm/chartjs-plugin-dragdata@2.2.3/dist/chartjs-plugin-dragdata.min.js"></script>
        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-datalabels/2.2.0/chartjs-plugin-datalabels.min.js"
            integrity="sha512-JPcRR8yFa8mmCsfrw4TNte1ZvF1e3+1SdGMslZvmrzDYxS69J7J49vkFL8u6u8PlPJK+H3voElBtUCzaXj+6ig=="
            crossorigin="anonymous" referrerpolicy="no-referrer"></script>



        <style>
            html,
            body {
                margin: 0;
                padding: 0;
            }



            .chart,
            canvas {
                width: 800px;
                padding: 10px;
            }

            .inputs {
                padding: 10px;
            }

        </style>
    </head>

    <body>
        <div class="chart">
            <canvas id="myChart"></canvas>

        </div>
        <div class="inputs">
            <input type="number" id="value0" min="0" max="10" onkeypress="return isNumeric(event)"
                oninput="maxLengthCheck(this)"
                onKeyUp="if(this.value>10){this.value='10';}else if(this.value<0){this.value='0';}">
            <input type="number" id="value1" min="0" max="10" onkeypress="return isNumeric(event)"
                oninput="maxLengthCheck(this)"
                onKeyUp="if(this.value>10){this.value='10';}else if(this.value<0){this.value='0';}">
            <input type="number" id="value2" min="0" max="10" onkeypress="return isNumeric(event)"
                oninput="maxLengthCheck(this)"
                onKeyUp="if(this.value>10){this.value='10';}else if(this.value<0){this.value='0';}">
            <input type="number" id="value3" min="0" max="10" onkeypress="return isNumeric(event)"
                oninput="maxLengthCheck(this)"
                onKeyUp="if(this.value>10){this.value='10';}else if(this.value<0){this.value='0';}">
            <input type="number" id="value4" min="0" max="10" onkeypress="return isNumeric(event)"
                oninput="maxLengthCheck(this)"
                onKeyUp="if(this.value>10){this.value='10';}else if(this.value<0){this.value='0';}">
            <input type="number" id="value5" min="0" max="10" onkeypress="return isNumeric(event)"
                oninput="maxLengthCheck(this)"
                onKeyUp="if(this.value>10){this.value='10';}else if(this.value<0){this.value='0';}">
            <input type="text" id="valuetotal" readonly="readonly">

        </div>


        <script>




            const data0 = 10;
            const data1 = 9;
            const data2 = 3;
            const data3 = 5;
            const data4 = 2;
            const data5 = 3;
            const datatotal = (data0 + data1 + data2 + data3 + data4 + data5) / 6;
            datatotal.value = Math.round((datatotal + Number.EPSILON) * 100) / 100;

            const value0 = document.getElementById('value0');
            const value1 = document.getElementById('value1');
            const value2 = document.getElementById('value2');
            const value3 = document.getElementById('value3');
            const value4 = document.getElementById('value4');
            const value5 = document.getElementById('value5');
            const valuetotal = document.getElementById('valuetotal');

            const labels = [['Story', value0.value], ['Pacing', value1.value], ['Visual', value2.value], ['Accessiblity', value3.value], ['Audio', value4.value], ['Gameplay', value5.value]];

            function maxLengthCheck(object) {
                if (object.value.length > object.max.length)
                    object.value = object.value.slice(0, object.max.length)
            }

            function isNumeric(evt) {
                var theEvent = evt || window.event;
                var key = theEvent.keyCode || theEvent.which;
                key = String.fromCharCode(key);
                var regex = /[0-9]/;
                if (!regex.test(key)) {
                    theEvent.returnValue = false;
                    if (theEvent.preventDefault) theEvent.preventDefault();
                }
            }


            let width, height, gradient;
            function getGradient(ctx, chartArea) {
                //     const chartArea = ctx.chart.chartArea;
                if (!chartArea) {
                    // This case happens on initial chart load
                    return;
                }

                const chartWidth = chartArea.right - chartArea.left;
                const chartHeight = chartArea.bottom - chartArea.top;
                if (!gradient) {
                    // Create the gradient because this is either the first render
                    // or the size of the chart has changed
                    width = chartWidth;
                    height = chartHeight;
                    const centerX = (chartArea.left + chartArea.right) / 2;
                    const centerY = (chartArea.top + chartArea.bottom) / 2;
                    const r = Math.min(
                        (chartArea.right - chartArea.left) / 2,
                        (chartArea.bottom - chartArea.top) / 2
                    );
                    //  gradient = ctx.createLinearGradient(0, chartArea.bottom, 0, chartArea.top);
                    gradient = ctx.createRadialGradient(centerX, centerY, 0, centerX, centerY, r);
                    gradient.addColorStop(0, "black");
                    gradient.addColorStop(0.1, "red");
                    gradient.addColorStop(0.4, "yellow");
                    gradient.addColorStop(1, "green");

                    /* gradient.addColorStop(0, "red");
                    gradient.addColorStop(0.15, "orange");
                    gradient.addColorStop(0.3, "yellow");
                    gradient.addColorStop(0.5, "green");
                    gradient.addColorStop(0.7, "blue");
                    gradient.addColorStop(0.85, "indigo");
                    gradient.addColorStop(1, "violet");*/

                }

                return gradient;
            }


            const colors = ["red", "yellow", "green"];


            const data = {
                labels: labels,
                datasets: [
                    {
                        label: '',
                        data: [data0, data1, data2, data3, data4, data5],
                        fill: 'origin',


                        //   borderColor: 'rgba(255, 99, 132, 1)',
                        borderColor: function (context) {
                            const chart = context.chart;
                            const { ctx, chartArea } = chart;

                            if (!chartArea) {
                                // This case happens on initial chart load
                                return;
                            }
                            return getGradient(ctx, chartArea);
                        },

                        /*
                                            borderColor: function (context) {
                                                let c = colors[context.dataIndex];
                                                if (!c) {
                                                    return;
                                                }
                                                if (context.active) {
                                                    c = helpers.getHoverColor(c);
                                                }
                                                const mid = helpers.color(c).desaturate(0.2).darken(0.2).rgbString();
                                                const start = helpers.color(c).lighten(0.2).rotate(270).rgbString();
                                                const end = helpers.color(c).lighten(0.1).rgbString();
                                                return createRadialGradient3(context, start, mid, end);
                                            },
                        */

                        borderWidth: 4,
                        pointHitRadius: 50,

                        // backgroundColor: "#8E24AA44",

                        backgroundColor: "#33333344",


                        pointBorderColor: "#000",
                        pointBackgroundColor: "rgba(1,250,48,1)",
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'black',
                        //     pointStyle: 'crossRot',
                        pointRadius: 4,
                        pointHoverRadius: 10,





                        datalabels: {
                            color: 'black',
                            font: {
                                weight: 'bold'
                            },


                        },
                    },
                    {
                        backgroundColor: '#fff',
                        borderColor: 'transparent',
                        pointRadius: 0,
                        data: [-2, -2, -2, -2, -2, -2],
                        fill: true,
                    },
                    {
                        backgroundColor: '#ff000011',
                        borderColor: 'transparent',
                        pointRadius: 0,
                        data: [2, 2, 2, 2, 2, 2],
                        fill: '-1',
                    },
                    {
                        backgroundColor: '#ffff0011',
                        borderColor: 'transparent',
                        pointRadius: 0,
                        data: [5, 5, 5, 5, 5, 5],
                        fill: '-1',
                    },
                    {
                        backgroundColor: '#00b05011',
                        borderColor: 'transparent',
                        pointRadius: 0,
                        data: [10, 10, 10, 10, 10, 10],
                        fill: '-1',
                    },
                ]
            };


            const config = {
                type: 'radar',
                data,
                plugins: [ChartDataLabels],
                options: {
                    responsive: false,
                    onHover: function (e) {
                        const point = e.chart.getElementsAtEventForMode(e, 'nearest', { intersect: true }, false)
                        if (point.length) e.native.target.style.cursor = 'grab'
                        else e.native.target.style.cursor = 'default'
                    },
                    scales: {
                        r: {
                            max: 10,
                            min: -2,
                            beginAtZero: true,

                            weight: 0,
                            border: {
                                color: 'green',
                                width: 5
                            },

                            angleLines: {
                                //  color: 'red'
                                color: ['red', 'orange', 'yellow', 'green', 'blue', 'indigo'],
                            },
                            grid: {

                                //   color: ['blue', 'cyan', 'chartreuse']
                                color: function (context) {
                                    const chart = context.chart;
                                    const { ctx, chartArea } = chart;

                                    if (!chartArea) {
                                        // This case happens on initial chart load
                                        return;
                                    }
                                    return getGradient(ctx, chartArea);
                                },
                            },
                            pointLabels: {
                                font: {
                                    size: 20
                                }
                            },
                            ticks: {
                                color: 'red',
                                //   color: ['red', 'green', 'yellow'],
                                display: false,
                                count: 10,
                                stepSize: 1,
                            }
                        }


                    },
                    plugins: {
                        filler: {
                            propagate: true
                        },
                        title: {
                            display: true,
                            align: "start",
                            text: ""
                        },
                        legend: {
                            align: "start",
                            display: false,


                        },
                        tooltip: {
                            enabled: false,
                        },
                        datalabels: {

                        },
                        dragData: {
                            round: 0,
                            showTooltip: false,
                            onDragStart: function (e) {
                                // console.log(e)

                            },
                            onDrag: function (e, datasetIndex, index, value) {
                                e.target.style.cursor = 'grabbing'
                                // console.log(e, datasetIndex, index, value)
                                if (value < 0) return false // this only allows positive values

                            },
                            onDragEnd: function (e, datasetIndex, index, value) {
                                e.target.style.cursor = 'default'
                                console.log(datasetIndex, index, value);
                                myChart.data.datasets[0].data[index] = value;
                                console.log(myChart.data.datasets[0].data[index]);
                                // value1.addEventListener('change', updateChartValue);
                                //  updateChartValue();
                                const inputboxes = document.getElementById('value' + index);
                                inputboxes.value = value;

                                updateChartValue();

                            },
                            //		  magnet: {
                            //	    to: Math.round // to: (value) => value + 5
                            //    }
                        },
                        ChartDataLabels: {},



                    },



                },
            };

            const myChart = new Chart(
                document.getElementById('myChart'),
                config

            );







            value0.value = data0;
            value1.value = data1;
            value2.value = data2;
            value3.value = data3;
            value4.value = data4;
            value5.value = data5;
            valuetotal.value = (data0 + data1 + data2 + data3 + data4 + data5) / 6;
            valuetotal.value = Math.round((datatotal + Number.EPSILON) * 100) / 100;
            //value0.value + value1.value + value2.value + value3.value + value4.value + value5.value = datatotal;



            value0.addEventListener('change', updateChartValue);
            value1.addEventListener('change', updateChartValue);
            value2.addEventListener('change', updateChartValue);
            value3.addEventListener('change', updateChartValue);
            value4.addEventListener('change', updateChartValue);
            value5.addEventListener('change', updateChartValue);
            //valuetotal.addEventListener('change', updateChartValue);




            function updateChartValue() {

                var data0 = parseFloat(document.getElementById("value0").value);
                if (isNaN(data0)) data0 = 0;
                var data1 = parseFloat(document.getElementById("value1").value);
                if (isNaN(data1)) data1 = 0;
                var data2 = parseFloat(document.getElementById("value2").value);
                if (isNaN(data2)) data2 = 0;
                var data3 = parseFloat(document.getElementById("value3").value);
                if (isNaN(data3)) data3 = 0;
                var data4 = parseFloat(document.getElementById("value4").value);
                if (isNaN(data4)) data4 = 0;
                var data5 = parseFloat(document.getElementById("value5").value);
                if (isNaN(data5)) data5 = 0;
                var result = (data0 + data1 + data2 + data3 + data4 + data5) / 6;
                result = Math.round((result + Number.EPSILON) * 100) / 100;
                document.getElementById("valuetotal").value = result;

                labels[0][1] = data0;
                labels[1][1] = data1;
                labels[2][1] = data2;
                labels[3][1] = data3;
                labels[4][1] = data4;
                labels[5][1] = data5;
                /*

                                var number0 = parseFloat(document.getElementById("value0").value);
                                if (isNaN(number0)) number0 = 0;
                                var number1 = parseFloat(document.getElementById("value1").value);
                                if (isNaN(number1)) number1 = 0;
                                var number2 = parseFloat(document.getElementById("value2").value);
                                if (isNaN(number2)) number2 = 0;
                                var number3 = parseFloat(document.getElementById("value3").value);
                                if (isNaN(number3)) number3 = 0;
                                var number4 = parseFloat(document.getElementById("value4").value);
                                if (isNaN(number4)) number4 = 0;
                                var number5 = parseFloat(document.getElementById("value5").value);
                                if (isNaN(number5)) number5 = 0;
                                var result = number0 + number1 + number2 + number3 + number4 + number5;
                                document.getElementById("valuetotal").value = result;
                */


                myChart.data.datasets[0].data[0] = value0.value;
                myChart.data.datasets[0].data[1] = value1.value;
                myChart.data.datasets[0].data[2] = value2.value;
                myChart.data.datasets[0].data[3] = value3.value;
                myChart.data.datasets[0].data[4] = value4.value;
                myChart.data.datasets[0].data[5] = value5.value;
                myChart.update();
            }

        </script>










    </body>

</html>
